---
import Layout from "../layouts/Base.astro";
import type { SanityDocument } from "@sanity/client";
import { sanityClient } from "sanity:client";
import imageUrlBuilder from "@sanity/image-url";
import type { SanityImageSource } from "@sanity/image-url/lib/types/types";

const builder = imageUrlBuilder(sanityClient);

function urlFor(source: SanityImageSource) {
  return builder.image(source);
}

const WORKS_QUERY = `*[
  _type == "work"
  && defined(slug.current)
]|order(order asc)[0...12]{
  _id, 
  title, 
  slug, 
  description,
  image {
    ...,
    hotspot,
    crop
  },
  tags,
}`;

const works = await sanityClient.fetch<SanityDocument[]>(WORKS_QUERY);
---

<Layout>
  <section class="">
    <div class="container-custom h-[34rem] flex flex-col">
      <!-- heading -->
      <div class="flex items-end lg:w-1/2 basis-1/2">
        <h1>I’m Ciel, and I bring ideas to life with design + code</h1>
      </div>
      <!-- summary -->
      <div class="flex basis-1/2 items-end">
        <div class="flex gap-6">
          <!-- curr + prev -->
          <div class="flex flex-col lg:flex-row basis-1/2 gap-6">
            <div class="flex flex-col gap-1 basis-1/2">
              <h5 class="small-text mb-2">Currently</h5>
              <div>
                <span>UX Designer @</span>
                <a href="https://www.northropgrumman.com/" target="_blank"
                  ><span>Northrop Grumman</span></a
                >
              </div>
            </div>
            <div>
              <h5 class="small-text mb-2">Previously</h5>
              <div class="gap-2 hidden md:flex">
                <span>UI Developer Intern @</span>
                <a href="https://viget.com" target="_blank"
                  ><span>Viget</span></a
                >
              </div>
            </div>
          </div>
          <!-- descr -->
          <div class="basis-1/2">
            <p>
              With a background in computer science + psychology, I bridge the
              gap between design vision and technical implementation.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Projects Section -->
  <section class="py-20 md:py-30 container-custom">
    <!-- <h2>✦ Experience</h2> -->

    <!-- Projects -->
    <div>
      <ul class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {
          works.map((work) => (
            <div class="flex flex-col col-gap-8">
              {/* class={`flex flex-col gap-8 
          ${index % 2 === 0 ? "basis-2/3" : "basis-1/3"}`} */}
              <div class="aspect-[5/3] outlined overflow-hidden">
                <a href={`/works/${work.slug.current}`}>
                  <img
                    src={urlFor(work.image).width(1200).url()}
                    srcset={`
									${urlFor(work.image).width(400).url()} 400w,
									${urlFor(work.image).width(800).url()} 800w,
									${urlFor(work.image).width(1200).url()} 1200w
									`}
                    sizes="(max-width: 768px) 400px, (max-width: 1024px) 800px, 1200px"
                    alt={work.image.alt}
                    class="w-full h-full object-cover mix-blend-luminosity hover:mix-blend-normal hover:scale-105 transition duration-450"
                  />
                </a>
              </div>
              <div class="flex justify-between pt-3">
                <h3 class="text-sm">{work.title}</h3>
                <h4 class="hidden md:block small-text">
                  {work.tags && work.tags.length > 0
                    ? work.tags.join(" ✦ ")
                    : ""}
                </h4>
              </div>
              {/* <h5 class="md:text-center">{work.description}</h5> */}
            </div>
          ))
        }
      </ul>
    </div>

    <!-- View All Projects Link -->
    <!-- 
			  <div class="text-center mt-16">
				<a href="/works" class="inline-flex items-center px-8 py-4 rounded-full border border-dark hover:bg-dark hover:text-light-beige transition-colors">
				  View All Projects
				</a>
			  </div> 
			  -->
  </section>
</Layout>
